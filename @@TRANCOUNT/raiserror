 if @@TRANCOUNT > 0 and @nNumeroError > 0 begin
      raiserror('Desfazendo. CÃ³digo do erro gerado %d',10,1,@nNumeroError) 
      rollback
   end

   if @@TRANCOUNT > 0 and @nNumeroError = 0 begin
      raiserror('Confirmando',10,1)
      Commit
   end 
